# End-to-end testing

ToolHive’s E2E suite uses Playwright to run the packaged Electron app and verify
critical flows (MCP servers, secrets, registry installs, and chat tool calls).

## Prerequisites

- `pnpm install`
- A built app in `out/` (generated by `pnpm package` or `pnpm e2e`)
- Ollama running locally (default: `http://localhost:11434`)

## Run the suite

- Full build + tests:
  - `pnpm run e2e`
- Tests only (reuse `out/`):
  - `pnpm run e2e:prebuilt`

## Environment variables

- `OLLAMA_BASE_URL`: Override the Ollama URL (default `http://localhost:11434`).
- `OLLAMA_MODEL`: Override the model used for the test (default `qwen2.5:1.5b`).
- `TOOLHIVE_E2E`: When `true`, disables telemetry/Sentry in the main process.

## Telemetry safeguards

During E2E runs, the suite:

- Sets `TOOLHIVE_E2E=true` for the Electron main process.
- Blocks any outbound requests to `*.sentry.io` in the renderer.
- Fails fast if a Sentry DSN is detected.

This ensures no telemetry is sent during automated tests.

## Troubleshooting

- Artifacts are written to `test-results/` and `test-videos/`.
- For UI debugging, use Playwright’s tracing or set `PWDEBUG=1`.
